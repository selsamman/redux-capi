<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Composing API Specs · redux-capi</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta name="description" content="There are times when you want to compose an API spec from other specs.  The challange in combining specs is to:"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="Composing API Specs · redux-capi"/><meta property="og:type" content="website"/><meta property="og:url" content="https://selsamman.github.io/redux-capi/"/><meta property="og:description" content="There are times when you want to compose an API spec from other specs.  The challange in combining specs is to:"/><meta property="og:image" content="https://selsamman.github.io/redux-capi/img/undraw_online.svg"/><meta name="twitter:card" content="summary"/><meta name="twitter:image" content="https://selsamman.github.io/redux-capi/img/undraw_tweetstorm.svg"/><link rel="shortcut icon" href="/redux-capi/img/capi.ico"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="/redux-capi/js/scrollSpy.js"></script><link rel="stylesheet" href="/redux-capi/css/main.css"/><script src="/redux-capi/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/redux-capi/"><img class="logo" src="/redux-capi/img/capi.ico" alt="redux-capi"/><h2 class="headerTitleWithLogo">redux-capi</h2></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"></ul></nav></div></header></div></div><div class="navPusher singleRowMobileNav"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>API Specs</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle">Introduction</h3><ul class=""><li class="navListItem"><a class="navItem" href="/redux-capi/docs/intro">What it is</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/intro_usage">Usage</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/intro_rationale">Rationale</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/intro_context">Context</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">API Specs</h3><ul class=""><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec">API Spec</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_redactions">Redactions</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_selectors">Selectors</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_thunks">Thunks</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_mounting">Mounting</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/redux-capi/docs/spec_composition">Composing</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_validation">Validation</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Reference</h3><ul class=""><li class="navListItem"><a class="navItem" href="/redux-capi/docs/reference_createAPI">createAPI</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/reference_api">API</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/reference_mount">api.mount()</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/reference_mocks">api.mock()</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/spec_dependency">Injection</a></li><li class="navListItem"><a class="navItem" href="/redux-capi/docs/reference_utility">Utilities</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle">Examples</h3><ul class=""><li class="navListItem"><a class="navItem" href="/redux-capi/docs/examples_todo">Todo List</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">Composing API Specs</h1></header><article><div><span><p>There are times when you want to compose an API spec from other specs.  The challange in combining specs is to:</p>
<ul>
<li>Apply the spec to a specific part of the state shape</li>
<li>Making sure you don't have naming conflicts in the API itself.</li>
</ul>
<p>The array form of the spec offers the ability to address both of these issues.  First you can include a spec in another spec and establish a mount point for it.</p>
<pre><code class="hljs"><span class="hljs-string">const</span> <span class="hljs-string">todoAPI</span> <span class="hljs-string">=</span> <span class="hljs-string">{</span>
    <span class="hljs-attr">redactions:</span> <span class="hljs-string">todoRedactions,</span>
    <span class="hljs-attr">selectors:</span> <span class="hljs-string">todoSelectors,</span>
    <span class="hljs-attr">thunks:</span> <span class="hljs-string">todoThunks,</span>
<span class="hljs-string">}</span>
<span class="hljs-string">const</span> <span class="hljs-string">composedAPI</span> <span class="hljs-string">=</span> <span class="hljs-string">createAPI(</span>
<span class="hljs-string">[</span>
  <span class="hljs-string">{</span>
    <span class="hljs-string">...todoAPI,</span>
    <span class="hljs-attr">api:</span> <span class="hljs-string">'home'</span><span class="hljs-string">,</span>
    <span class="hljs-attr">mount:</span> <span class="hljs-string">{homeTodos:</span> <span class="hljs-literal">true</span><span class="hljs-string">}</span>     
  <span class="hljs-string">},</span> <span class="hljs-string">{</span>
    <span class="hljs-string">...todoAPI,</span>
    <span class="hljs-attr">api:</span> <span class="hljs-string">'work'</span><span class="hljs-string">,</span>
    <span class="hljs-attr">mount:</span> <span class="hljs-string">{workTodos:</span> <span class="hljs-literal">true</span><span class="hljs-string">}</span>     
  <span class="hljs-string">}</span>
<span class="hljs-string">]</span>
<span class="hljs-string">);</span>
</code></pre>
<p>Here we have the same todoList api that is used for a work list and a home list.  Each will be mounted to a separate state property (homeTodos and workTodos) and within the API itself there needs to be a separate set of redactions each of which is available on it's own propertery (home and work).</p>
<p>In the API you would access each like this</p>
<pre><code class="hljs"><span class="hljs-keyword">const</span> {work, <span class="hljs-built_in">home</span>} = composedAPI();
work.addItem(<span class="hljs-string">"Foo"</span>)
<span class="hljs-built_in">home</span>.addItem(<span class="hljs-string">"Bar"</span>);
</code></pre>
<p>Remember that in most cases it is better to just create separate APIs and if this was all there was to the combined APIs that would probably be the better option.  However they may be cases where logic, maybe even in the API itself needs access to both specs and that case you can use the api property as in this example.</p>
<p>In case you need to include multiple specs and apply them to a single API property and mount point you can use the spec property as in:</p>
<pre><code class="hljs"><span class="hljs-string">const</span> <span class="hljs-string">composedAPI</span> <span class="hljs-string">=</span> <span class="hljs-string">createAPI([</span>
  <span class="hljs-string">{</span>
    <span class="hljs-attr">spec:</span> <span class="hljs-string">[normalTodoAPI,</span> <span class="hljs-string">extendedTodoAPI],</span>
    <span class="hljs-attr">api:</span> <span class="hljs-string">'home'</span><span class="hljs-string">,</span>
    <span class="hljs-attr">mount:</span> <span class="hljs-string">{homeTodos:</span> <span class="hljs-literal">true</span><span class="hljs-string">}</span>     
  <span class="hljs-string">}</span>
<span class="hljs-string">}</span>
</code></pre>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/redux-capi/docs/spec_mounting"><span class="arrow-prev">← </span><span>Mounting</span></a><a class="docs-next button" href="/redux-capi/docs/spec_validation"><span>Validation</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"></nav></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/redux-capi/" class="nav-home"><img src="/redux-capi/img/capi.ico" alt="redux-capi" width="66" height="58"/></a><div><h5>Docs</h5><a href="/redux-capi/docs/en/doc1.html">Getting Started (or other categories)</a><a href="/redux-capi/docs/en/doc2.html">Guides (or other categories)</a><a href="/redux-capi/docs/en/doc3.html">API Reference (or other categories)</a></div><div><h5>Community</h5><a href="/redux-capi/en/users.html">User Showcase</a><a href="https://stackoverflow.com/questions/tagged/" target="_blank" rel="noreferrer noopener">Stack Overflow</a><a href="https://discordapp.com/">Project Chat</a><a href="https://twitter.com/" target="_blank" rel="noreferrer noopener">Twitter</a></div><div><h5>More</h5><a href="/redux-capi/blog">Blog</a><a href="https://github.com/">GitHub</a><a class="github-button" data-icon="octicon-star" data-count-href="/facebook/docusaurus/stargazers" data-show-count="true" data-count-aria-label="# stargazers on GitHub" aria-label="Star this project on GitHub">Star</a></div></section><a href="https://opensource.facebook.com/" target="_blank" rel="noreferrer noopener" class="fbOpenSource"><img src="/redux-capi/img/oss_logo.png" alt="Facebook Open Source" width="170" height="45"/></a><section class="copyright">Copyright © 2020 Sam Elsamman</section></footer></div></body></html>